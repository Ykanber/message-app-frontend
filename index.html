<!DOCTYPE html>
<html>
<head>
  <title>Chat App</title>
  <style>
    body { font-family: Arial, sans-serif; display: flex; flex-direction: column; align-items: center; margin-top: 30px; }
    #chat { width: 300px; height: 400px; border: 1px solid #ccc; overflow-y: auto; padding: 10px; margin-bottom: 10px; }
    #messageInput { width: 300px; }
  </style>
</head>
<body>
<h1>Chat App</h1>
<div id="chat"></div>
<input type="text" id="messageInput" placeholder="Type your message...">
<button onclick="sendMessage()">Send</button>

<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

<script>
  const socket = io("https://message-app-server.onrender.com");
  socket.on("connect", () => {
    console.log("✅ Connected to backend:", socket.id);
  });

  socket.on("connect_error", (error) => {
    console.error("❌ Connection Error:", error);
  });

  socket.on("disconnect", (reason) => {
    console.warn("🔌 Disconnected:", reason);
  });


  const chat = document.getElementById("chat");
  const messageInput = document.getElementById("messageInput");

  // When receiving past messages from the server
  socket.on("gecmisMesajlar", (messages) => {
    messages.forEach(msg => {
      chat.innerHTML += `<p>${msg}</p>`;
    });
    chat.scrollTop = chat.scrollHeight;
  });

  // When receiving a new message from any user
  socket.on("mesaj", (msg) => {
    chat.innerHTML += `<p>${msg}</p>`;
    chat.scrollTop = chat.scrollHeight;
  });

  // Send message function
  function sendMessage() {
    const message = messageInput.value.trim();
    if (message !== "") {
      socket.emit("mesajGonder", message);
      messageInput.value = "";
    }
  }

  // Optional: Send message on Enter key press
  messageInput.addEventListener("keypress", function(event) {
    if (event.key === "Enter") {
      sendMessage();
    }
  });
</script>
</body>
</html>
